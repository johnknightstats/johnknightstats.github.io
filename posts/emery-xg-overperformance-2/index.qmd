---
title: "Unai Emery: the xG whisperer"
draft: true
image: emery2.jpg
author: "John Knight"
date: 2026-01-07
date-format: "D MMMM YYYY"
description: "Part two: Breaking down Emery by club, and looking at forward keepers, and game state."
format:
  html:
    title-block-categories: true
categories: ["football", "statistics", "Unai Emery", "Aston Villa", "Premier League"]
execute: 
  echo: false
  eval: true
  message: false
  warning: false
engine: knitr
editor: source
# resources:


---

This is a multi-part look at Unai Emery and his apparent habit of outperforming expected goals (xG). In part one, I showed that xG is a more predictive statistic than points or goal difference, and that Emery ranks third among all managers for xG overperformance during the study period (2017-2018 to 2024-2025). You can find part one [here](https://johnknightstats.com/posts/emery-xg-overperformance/).

Next, I want to drill down on Emery's stints at PSG, Arsenal, Villarreal and Aston Villa during those seasons. We know that his teams, cumulatively, have scored more than their expected goals for, and conceded fewer than their expected goals against. But where have these gains come from?

An obvious starting point is to break it down by club. Here we can see a breakdown of Emery's xG overperformance per game with each of the four clubs, with attacking overperformance in blue and defensive overperformance in orange.

::: {.centered-block}
<img src="viz/emery_xg_overperformance_totals.png"/>
<em>Emery has outperformed xG at all of his last four clubs, on both the attacking and defensive ends of the pitch.</em>
:::

All four clubs, with Emery as manager, have performed better than xG in both attack and defence. And there's an obvious point to be made, especially with respect to PSG and Arsenal: is this just about having better players? These are wealthy clubs that can sign better-than-average footballers in every position; it's no wonder that they will excel at whatever minutiae the xG models cannot capture.

This is fair, so let's take a look at how these clubs have performed, relative to xG, with and without Unai Emery as manager during the study period:

```{r}
library(dplyr)
library(readr)
library(gt)

# -----------------------------

# Read + prep

# -----------------------------


df <- read_csv("data/emery_vs_not_emery_by_club.csv", show_col_types = FALSE)


table_df <- df %>%
transmute(
Club = Club,
`Matches (Emery)` = as.integer(matches_emery),
`xG overperformance per match (Emery)` = round(opm_emery, 3),
`Matches (Other)` = as.integer(matches_not),
`xG overperformance per match (Other)` = round(opm_not, 3)
) %>%
arrange(desc(`xG overperformance per match (Emery)`), Club)

# -----------------------------

# Export for Datawrapper

# -----------------------------

# Datawrapper generally likes a clean CSV with the exact columns you want to chart.

write_csv(table_df, "data/emery_vs_other_managers_datawrapper.csv")

# -----------------------------

# Table (Quarto article)

# -----------------------------

gt_tbl <- table_df %>%
gt() %>%
tab_header(
title = "Unai Emery xG overperformance by club relative to other managers (2017-2025)"
) %>%
tab_source_note(
source_note = "xG overperformance = goals − expected goals.") %>%
  tab_style(
style = cell_text(size = px(11), style = "italic", align = "left"),
locations = cells_source_notes()
) %>%
tab_style(
style = list(
cell_fill(color = "#f2f2f2"),
cell_text(weight = "bold")
),
locations = cells_column_labels(everything())
) %>%
tab_options(
table.border.top.style = "solid",
table.border.top.width = px(1),
table.border.top.color = "#d9d9d9",

heading.border.bottom.style = "solid",
heading.border.bottom.width = px(1),
heading.border.bottom.color = "#d9d9d9",

column_labels.border.bottom.style = "solid",
column_labels.border.bottom.width = px(2),
column_labels.border.bottom.color = "#d0d0d0",

data_row.padding = px(6),
heading.padding = px(6),
column_labels.padding = px(6),

table.border.bottom.style = "none",
table.font.size = px(14)

) %>%
  cols_width(
  Club ~ pct(34),
  `Matches (Emery)` ~ px(90),
  `xG overperformance per match (Emery)` ~ px(170),
  `Matches (Other)` ~ px(90),
  `xG overperformance per match (Other)` ~ px(170)
) %>%
cols_align(align = "left", columns = Club) %>%
cols_align(
align = "center",
columns = c(`Matches (Emery)`, `Matches (Other)`)
) %>%
cols_align(
align = "right",
columns = c(`xG overperformance per match (Emery)`, `xG overperformance per match (Other)`)
) %>%
fmt_number(
columns = c(`xG overperformance per match (Emery)`, `xG overperformance per match (Other)`),
decimals = 3
)

# Optional: save a PNG snapshot (useful for Substack or social)

gtsave(gt_tbl, filename = "emery_vs_other_managers_table.png", vwidth = 1200)

gt_tbl
```

Again, I want to reiterate that this is a measure of goals relative to xG - it does NOT measure whether the xG is high or low in the first place. But it is clear that Emery has done better, relative to xG, at each of the four clubs than all the other managers collectively. PSG and Arsenal have outperformed xG across all managers, whereas Aston Villa and Villarreal are close to neutral under non-Emery managers, backing up the hypothesis that wealth -> talent -> xG overperformance.

So if we suspect star players may be driving some of the 'Emery effect', let's take a look at the goalscorers who have exceeded their xG by the most while playing for Emery teams between 2017 and 2025:

```{r}
library(dplyr)
library(readr)
library(gt)

# -----------------------------

# Read + prep

# -----------------------------

df <- read_csv(
"data/player_finishing_emery_vs_not_emery_from_shots.csv",
show_col_types = FALSE
) %>%
mutate(
full_name = if_else(full_name == "Jáder Durán", "Jhon Durán", full_name)
)

# Defensive check (fail loudly if schema changes)

required_cols <- c(
"full_name",
"emery_goals_minus_xg",
"emery_goals_minus_xg_per_shot",
"not_emery_goals_minus_xg",
"not_emery_goals_minus_xg_per_shot",
"emery_shots",
"not_emery_shots"
)

missing <- setdiff(required_cols, names(df))
if (length(missing) > 0) {
stop("Missing required columns: ", paste(missing, collapse = ", "))
}

table_df <- df %>%
transmute(
Player = full_name,
`Shots (Emery)` = as.integer(emery_shots),
`xG overperformance (Emery)` = round(emery_goals_minus_xg, 2),
`per shot (Emery)` = round(emery_goals_minus_xg_per_shot, 3),
`Shots (Other)` = as.integer(not_emery_shots),
`xG overperformance (Other)` = round(not_emery_goals_minus_xg, 2),
`per shot (Other)` = round(not_emery_goals_minus_xg_per_shot, 3)
) %>%
arrange(desc(`xG overperformance (Emery)`), Player) %>%
slice_head(n = 10)

# -----------------------------

# Export for Datawrapper

# -----------------------------

write_csv(
table_df,
"data/player_finishing_emery_vs_other_datawrapper.csv"
)

# -----------------------------

# Table (Quarto article)

# -----------------------------

gt_tbl <- table_df %>%
gt() %>%
tab_header(
title = "Top xG overperformers under Unai Emery (2017-2025)"
) %>%
tab_source_note(
source_note = "xG overperformance = goals − expected goals."
) %>%
tab_style(
style = list(
cell_fill(color = "#f2f2f2"),
cell_text(weight = "bold")
),
locations = cells_column_labels(everything())
) %>%
tab_style(
style = cell_text(size = px(11), style = "italic", align = "left"),
locations = cells_source_notes()
) %>%
tab_options(
table.border.top.style = "solid",
table.border.top.width = px(1),
table.border.top.color = "#d9d9d9",

heading.border.bottom.style = "solid",
heading.border.bottom.width = px(1),
heading.border.bottom.color = "#d9d9d9",

column_labels.border.bottom.style = "solid",
column_labels.border.bottom.width = px(2),
column_labels.border.bottom.color = "#d0d0d0",

data_row.padding = px(6),
heading.padding = px(6),
column_labels.padding = px(6),

table.border.bottom.style = "none",
table.font.size = px(14)


) %>%
cols_width(
Player ~ pct(30),
`Shots (Emery)` ~ px(105),
`xG overperformance (Emery)` ~ px(170),
`per shot (Emery)` ~ px(135),
`Shots (Other)` ~ px(105),
`xG overperformance (Other)` ~ px(170),
`per shot (Other)` ~ px(135)
) %>%
cols_align(align = "left", columns = Player) %>%
cols_align(
align = "right",
columns = -Player
) %>%
fmt_number(
columns = c(
`xG overperformance (Emery)`,
`xG overperformance (Other)`
),
decimals = 2
) %>%
fmt_number(
columns = c(
`per shot (Emery)`,
`per shot (Other)`
),
decimals = 3
)

# Optional PNG export (useful for Substack / social)

gtsave(
gt_tbl,
filename = "top10_finishers_emery_vs_other.png",
vwidth = 1200
)

gt_tbl
```

There are some familiar names on the list, but only Neymar and Lacazette were able to sustain their finishing prowess under different managers. Edinson Cavani underperformed his xG in subsequent seasons with PSG, Man Utd and Valencia. Ollie Watkins has established himself as a star striker at Emery's Villa, but had previously been seen as a hard worker but poor finisher. Alex Baena, meanwhile, experienced an outrageous run of finishing in his short time playing for Emery's Villarreal, scoring 9 times from only 37 shots and gaining 6.31 goals; yet without Emery, his shooting boots deserted him, completely negating the hot run (-6.45 goals).

The defensive end of the pitch is a bit harder to measure directly, but we can take a look at goalkeepers. Post-shot expected goals (PSxG) models the probability of a goal being scored after the ball is struck (an off-target shot therefore being worth zero) and we can look at a goalkeeper's "goals prevented" by subtracting the actual number of goals conceded from their total PSxG.

```{r}
library(dplyr)
library(readr)
library(gt)

# -----------------------------

# Read + prep

# -----------------------------

df <- read_csv(
"data/goalkeeper_psxg_emery_vs_not_emery.csv",
show_col_types = FALSE
) %>%
  filter(`emery_matches` >= 5)

# Defensive check (fail loudly if schema changes)

required_cols <- c(
"full_name",
"emery_matches",
"emery_goals_prevented",
"emery_goals_prevented_per_match",
"not_emery_matches",
"not_emery_goals_prevented",
"not_emery_goals_prevented_per_match"
)

missing <- setdiff(required_cols, names(df))
if (length(missing) > 0) {
stop("Missing required columns: ", paste(missing, collapse = ", "))
}

table_df <- df %>%
transmute(
Goalkeeper = full_name,
`Matches (Emery)` = as.integer(emery_matches),
`Goals prevented (Emery)` = round(emery_goals_prevented, 1),
`per match (Emery)` = round(emery_goals_prevented_per_match, 3),
`Matches (Other)` = as.integer(not_emery_matches),
`Goals prevented (Other)` = round(not_emery_goals_prevented, 1),
`per match (Other)` = round(not_emery_goals_prevented_per_match, 3)
) %>%
arrange(desc(`Goals prevented (Emery)`), Goalkeeper)

# -----------------------------

# Export for Datawrapper

# -----------------------------

write_csv(
table_df,
"data/goalkeeper_psxg_emery_vs_other_datawrapper.csv"
)

# -----------------------------

# Table (Quarto article)

# -----------------------------

gt_tbl <- table_df %>%
gt() %>%
tab_header(
title = "Goalkeepers under Unai Emery (2017-2025)"
) %>%
tab_source_note(
source_note = "Goals prevented = PSxG − goals against. Minumum 5 matches played under Emery."
) %>%
tab_style(
style = list(
cell_fill(color = "#f2f2f2"),
cell_text(weight = "bold")
),
locations = cells_column_labels(everything())
) %>%
tab_style(
style = cell_text(size = px(11), style = "italic", align = "left"),
locations = cells_source_notes()
) %>%
tab_options(
table.border.top.style = "solid",
table.border.top.width = px(1),
table.border.top.color = "#d9d9d9",

heading.border.bottom.style = "solid",
heading.border.bottom.width = px(1),
heading.border.bottom.color = "#d9d9d9",

column_labels.border.bottom.style = "solid",
column_labels.border.bottom.width = px(2),
column_labels.border.bottom.color = "#d0d0d0",

data_row.padding = px(6),
heading.padding = px(6),
column_labels.padding = px(6),

table.border.bottom.style = "none",
table.font.size = px(14)

) %>%
cols_width(
Goalkeeper ~ pct(30),
`Matches (Emery)` ~ px(110),
`Goals prevented (Emery)` ~ px(175),
`per match (Emery)` ~ px(140),
`Matches (Other)` ~ px(110),
`Goals prevented (Other)` ~ px(175),
`per match (Other)` ~ px(140)
) %>%
cols_align(align = "left", columns = Goalkeeper) %>%
cols_align(align = "right", columns = -Goalkeeper) %>%
fmt_number(
columns = c(`Goals prevented (Emery)`, `Goals prevented (Other)`),
decimals = 1
) %>%
fmt_number(
columns = c(`per match (Emery)`, `per match (Other)`),
decimals = 3
)

# Optional PNG export (useful for Substack / social)

gtsave(
gt_tbl,
filename = "top10_goalkeepers_emery_vs_other.png",
vwidth = 1200
)

gt_tbl
```




Emery by game state versus all by game state.

*side by side bar chart*

Mixed effects regression model.

GD to PPG model (linear).

*scatterplot*

Emery versus predicted points.

*emery stints csv*

Emery scoreline distribution.

*column charts*

Conclusion: Exceeding xG yes, exceeding GD no. Players, maybe. Introduce next part: How predictive is this? Build a model respecting chronology, and validate by using it to predict xG overperformance this season. 





